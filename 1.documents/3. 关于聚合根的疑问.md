# æœ‰å…³èšåˆæ ¹,ä»¥åŠé‡Œé¢çš„å€¼å¯¹è±¡æˆ‘æƒ³æ·±å…¥ç†è§£ä¸€ä¸‹ï¼Œ

æ¯”æ–¹è¯´ä½ çš„ä¸¾ä¾‹èšåˆæ ¹ - Order æè¿°çš„æ˜¯è®¢å•ï¼Œè¿™å…¶å®å°±æ˜¯ä¸€ä¸ªè¾¹ç•Œäº†å“ˆï¼Ÿç„¶å

```
private List<OrderItem> orderItems; // å†…éƒ¨å®ä½“

private Address shippingAddress;       // å€¼å¯¹è±¡
```

è¿™ä¸¤ä¸ª å†…éƒ¨å®ä½“å’Œå€¼å¯¹è±¡æœ‰ä»€ä¹ˆåŒºåˆ«å—ï¼Ÿä»–ä»¬éƒ½æ˜¯æœ‰å•ç‹¬çš„æ•°æ®åº“è¡¨å¯¹åº”çš„å—ï¼Ÿ

å†…éƒ¨å®ä½“ï¼ˆå¦‚ OrderItemï¼‰é€šå¸¸ä¼šæœ‰è‡ªå·±çš„è¡¨ï¼Œè€Œå€¼å¯¹è±¡ï¼ˆå¦‚ Addressï¼‰é€šå¸¸åµŒå…¥åœ¨è®¢å•è¡¨ä¸­ã€‚
æ–¹æ¡ˆ 1ï¼šæœ€å¸¸ç”¨çš„æ–¹å¼ï¼ˆ90%é¡¹ç›®ï¼‰

```
-- è®¢å•è¡¨ï¼ˆèšåˆæ ¹ï¼‰
CREATE TABLE orders (
    id BIGINT PRIMARY KEY,
    customer_id BIGINT,
    status VARCHAR(20),
    total_amount DECIMAL(10,2),
    created_at TIMESTAMP
);

-- è®¢å•é¡¹è¡¨ï¼ˆå†…éƒ¨å®ä½“ï¼‰- æœ‰è‡ªå·±çš„è¡¨
CREATE TABLE order_items (
    id BIGINT PRIMARY KEY,
    order_id BIGINT NOT NULL,  -- å¤–é”®å…³è”è®¢å•
    product_id BIGINT NOT NULL,
    product_name VARCHAR(100),
    quantity INT NOT NULL,
    unit_price DECIMAL(10,2),
    FOREIGN KEY (order_id) REFERENCES orders(id) ON DELETE CASCADE
);

-- åœ°å€ä¿¡æ¯ï¼ˆå€¼å¯¹è±¡ï¼‰- åµŒå…¥è®¢å•è¡¨
-- ç›´æ¥åœ¨ordersè¡¨ä¸­æ·»åŠ è¿™äº›åˆ—ï¼š
-- shipping_province VARCHAR(50),
-- shipping_city VARCHAR(50),
-- shipping_address VARCHAR(200),
-- recipient_name VARCHAR(50),
-- recipient_phone VARCHAR(20)
```

# åœ°å€ä¿¡æ¯ï¼ˆå€¼å¯¹è±¡ï¼‰ï¼Œæ˜¯æ²¡æœ‰å•ç‹¬çš„è¡¨çš„å“ˆï¼Œé‚£æˆ‘æƒ³çŸ¥é“ ä»€ä¹ˆå«åš å†…éƒ¨å®ä½“ï¼Œä»€ä¹ˆæ‰å«åšå€¼å¯¹è±¡å‘€ï¼Œå¤ªä¸æ¸…æ™°äº†

## çœŸæ­£çš„åŒºåˆ«æ ‡å‡†

## å€¼å¯¹è±¡ï¼ˆValue Objectï¼‰çš„ç‰¹å¾ï¼š

- æ²¡æœ‰æ¦‚å¿µä¸Šçš„æ ‡è¯†ï¼šé€šè¿‡å±æ€§å€¼æ¥å®šä¹‰èº«ä»½

- ä¸å¯å˜ï¼šåˆ›å»ºåå°±ä¸èƒ½ä¿®æ”¹

- å¯æ›¿æ¢ï¼šéœ€è¦"ä¿®æ”¹"æ—¶å°±åˆ›å»ºæ–°çš„æ›¿æ¢æ—§çš„

- æè¿°æ€§çš„ï¼šæè¿°æŸä¸ªäº‹ç‰©çš„ç‰¹å¾ã€å±æ€§

## å†…éƒ¨å®ä½“ï¼ˆEntityï¼‰çš„ç‰¹å¾ï¼š

- æœ‰æ ‡è¯†ï¼šæœ‰å”¯ä¸€ ID æˆ–é€šè¿‡å…³é”®å±æ€§æ ‡è¯†

- å¯å˜ï¼šå¯ä»¥ä¿®æ”¹å±æ€§è€Œä¿æŒèº«ä»½ä¸å˜

- æœ‰ç”Ÿå‘½å‘¨æœŸï¼šåœ¨èšåˆå†…æœ‰ç‹¬ç«‹çš„åˆ›å»ºã€ä¿®æ”¹ã€åˆ é™¤

- æœ‰è¡Œä¸ºï¼šæœ‰è‡ªå·±çš„ä¸šåŠ¡é€»è¾‘å’Œæ–¹æ³•

# ğŸ¯ é‡æ–°ç†è§£ Order ä¾‹å­

åœºæ™¯åˆ†æï¼šç”µå•†è®¢å•

1. åœ°å€ä¿¡æ¯ï¼ˆå€¼å¯¹è±¡ï¼‰

```
public class Address {
    private final String province;
    private final String city;
    private final String street;
    private final String zipCode;

    // è¡Œä¸ºï¼šéªŒè¯åœ°å€æœ‰æ•ˆæ€§
    public boolean isValid() {
        return province != null && city != null && !street.isEmpty();
    }

    // å¦‚æœéœ€è¦"ä¿®æ”¹"ï¼Œå°±åˆ›å»ºæ–°çš„
    public Address withNewStreet(String newStreet) {
        return new Address(this.province, this.city, newStreet, this.zipCode);
    }
}
```

## ä¸ºä»€ä¹ˆæ˜¯å€¼å¯¹è±¡ï¼Ÿ

"åŒ—äº¬å¸‚æµ·æ·€åŒºä¸­å…³æ‘å¤§è¡— 1 å·" å’Œ "åŒ—äº¬å¸‚æµ·æ·€åŒºä¸­å…³æ‘å¤§è¡— 1 å·" æ˜¯åŒä¸€ä¸ªåœ°å€

å¦‚æœç”¨æˆ·è¦æ”¹åœ°å€ï¼Œæˆ‘ä»¬ä¸æ˜¯ä¿®æ”¹ç°æœ‰åœ°å€ï¼Œè€Œæ˜¯æ•´ä¸ªæ›¿æ¢æˆæ–°åœ°å€

ä¸šåŠ¡ä¸Šä¸å…³å¿ƒ"è¿™ä¸ªåœ°å€å¯¹è±¡çš„å†å²"ï¼Œåªå…³å¿ƒ"å½“å‰æ˜¯ä»€ä¹ˆåœ°å€"

2. è®¢å•é¡¹ï¼ˆå†…éƒ¨å®ä½“ï¼‰

```
public class OrderItem {
    private OrderItemId id;        // æˆ–è€…ç”¨ productId ä½œä¸ºæ ‡è¯†
    private ProductId productId;
    private String productName;
    private int quantity;
    private Money price;

    // è¡Œä¸ºï¼šä¿®æ”¹æ•°é‡
    public void updateQuantity(int newQuantity) {
        if (newQuantity <= 0) {
            throw new InvalidQuantityException("æ•°é‡å¿…é¡»å¤§äº0");
        }
        this.quantity = newQuantity;
        // æ³¨æ„ï¼šè¿™é‡Œä¿®æ”¹äº†å±æ€§ï¼Œä½†è®¢å•é¡¹çš„èº«ä»½æ²¡å˜ï¼
    }

    // è¡Œä¸ºï¼šåº”ç”¨æŠ˜æ‰£
    public void applyDiscount(Percentage discount) {
        this.price = this.price.applyDiscount(discount);
    }
}
```

## ä¸ºä»€ä¹ˆæ˜¯å†…éƒ¨å®ä½“ï¼Ÿ

å³ä½¿æŠŠæ•°é‡ä» 2 æ”¹æˆ 3ï¼Œå®ƒè¿˜æ˜¯åŒä¸€ä¸ªè®¢å•é¡¹

åœ¨è®¢å•å†…ï¼Œå¯èƒ½éœ€è¦å•ç‹¬æ“ä½œæŸä¸ªè®¢å•é¡¹ï¼ˆä¿®æ”¹æ•°é‡ã€åº”ç”¨æŠ˜æ‰£ï¼‰

æœ‰ç‹¬ç«‹çš„ä¸šåŠ¡é€»è¾‘å’ŒçŠ¶æ€å˜åŒ–

#ğŸ” æ›´æ¸…æ™°çš„åˆ¤æ–­æ–¹æ³•

é—®è‡ªå·±è¿™äº›é—®é¢˜ï¼š

## åˆ¤æ–­å€¼å¯¹è±¡ï¼š

é—®é¢˜ 1ï¼šå¦‚æœæ‰€æœ‰å±æ€§å€¼éƒ½ç›¸åŒï¼Œæ˜¯ä¸æ˜¯åŒä¸€ä¸ªä¸œè¥¿ï¼Ÿ âœ…

é—®é¢˜ 2ï¼šéœ€ä¸éœ€è¦è·Ÿè¸ªè¿™ä¸ªå¯¹è±¡çš„ä¸ªä½“å˜åŒ–ï¼Ÿ âŒ

é—®é¢˜ 3ï¼šä¿®æ”¹æ—¶æ˜¯æ›¿æ¢æ•´ä¸ªå¯¹è±¡ï¼Œè¿˜æ˜¯ä¿®æ”¹éƒ¨åˆ†å±æ€§ï¼Ÿ ğŸ”„ æ›¿æ¢

## åˆ¤æ–­å†…éƒ¨å®ä½“ï¼š

é—®é¢˜ 1ï¼šå³ä½¿å±æ€§æ”¹å˜äº†ï¼Œè¿˜æ˜¯ä¸æ˜¯åŒä¸€ä¸ªä¸œè¥¿ï¼Ÿ âœ…

é—®é¢˜ 2ï¼šéœ€ä¸éœ€è¦å•ç‹¬æ ‡è¯†å’Œå¼•ç”¨è¿™ä¸ªå¯¹è±¡ï¼Ÿ âœ…

é—®é¢˜ 3ï¼šæœ‰æ²¡æœ‰ç‹¬ç«‹çš„è¡Œä¸ºå’Œç”Ÿå‘½å‘¨æœŸï¼Ÿ âœ…

# å€¼å¯¹è±¡çš„æ•°æ®æ˜¯ç›´æ¥è·Ÿ Order ç”¨åŒä¸€ä¸ªè¡¨ä¸­å—ï¼Œä¸éœ€è¦å•ç‹¬å»ºè¡¨å—

ç®€å•ç›´æ¥çš„ç­”æ¡ˆ
æ˜¯çš„ï¼Œå€¼å¯¹è±¡çš„æ•°æ®é€šå¸¸ç›´æ¥å­˜å‚¨åœ¨èšåˆæ ¹çš„è¡¨ä¸­ï¼Œä¸éœ€è¦å•ç‹¬å»ºè¡¨ã€‚ è¿™æ˜¯æœ€å¸¸è§çš„åšæ³•ã€‚
ğŸ—„ï¸ å€¼å¯¹è±¡çš„å­˜å‚¨æ–¹å¼
æ–¹æ¡ˆä¸€ï¼šåµŒå…¥åŒä¸€å¼ è¡¨ï¼ˆæœ€æ¨èã€æœ€å¸¸ç”¨ï¼‰

```
CREATE TABLE orders (
    id BIGINT PRIMARY KEY,
    customer_id BIGINT,
    status VARCHAR(20),
    total_amount DECIMAL(10,2),

    -- åœ°å€å€¼å¯¹è±¡ç›´æ¥ä½œä¸ºåˆ—åµŒå…¥
    shipping_province VARCHAR(50),
    shipping_city VARCHAR(50),
    shipping_street VARCHAR(200),
    shipping_zipcode VARCHAR(20),
    recipient_name VARCHAR(50),
    recipient_phone VARCHAR(20),

    created_at TIMESTAMP
);
```

ä»£ç ä¸­çš„æ˜ å°„ï¼š

```
// Orderèšåˆæ ¹
public class Order {
    private OrderId id;
    private CustomerId customerId;
    private OrderStatus status;
    private Address shippingAddress;  // å€¼å¯¹è±¡
    private List<OrderItem> orderItems;

    // æ„é€ å‡½æ•°ç­‰...
}

// å€¼å¯¹è±¡ - æ²¡æœ‰è‡ªå·±çš„è¡¨
public class Address {
    private final String province;
    private final String city;
    private final String street;
    private final String zipCode;
    private final String recipientName;
    private final String recipientPhone;

    // æ„é€ å‡½æ•°ã€equalsã€hashCodeç­‰...
}
```

Repository å®ç°ï¼š

```
@Repository
public class OrderRepositoryImpl implements OrderRepository {

    public Order findById(OrderId id) {
        String sql = "SELECT id, customer_id, status, " +
                    "shipping_province, shipping_city, shipping_street, " +
                    "shipping_zipcode, recipient_name, recipient_phone " +
                    "FROM orders WHERE id = ?";

        return jdbcTemplate.queryForObject(sql, (rs, rowNum) -> {
            // ä»åŒä¸€è¡Œæ•°æ®ä¸­æ„é€ å€¼å¯¹è±¡
            Address address = new Address(
                rs.getString("shipping_province"),
                rs.getString("shipping_city"),
                rs.getString("shipping_street"),
                rs.getString("shipping_zipcode"),
                rs.getString("recipient_name"),
                rs.getString("recipient_phone")
            );

            return new Order(
                new OrderId(rs.getLong("id")),
                new CustomerId(rs.getLong("customer_id")),
                OrderStatus.valueOf(rs.getString("status")),
                address,  // å€¼å¯¹è±¡
                // ... å…¶ä»–å­—æ®µ
            );
        }, id.getValue());
    }
}
```

# ğŸ¤” ä¸ºä»€ä¹ˆå€¼å¯¹è±¡ä¸éœ€è¦å•ç‹¬è¡¨ï¼Ÿ

## ä¸šåŠ¡è§’åº¦ï¼š

æ•´ä½“æ€§ï¼šåœ°å€æ€»æ˜¯ä½œä¸ºè®¢å•çš„ä¸€éƒ¨åˆ†è¢«ä½¿ç”¨

ä¸å¯å˜æ€§ï¼šä¿®æ”¹åœ°å€å°±æ˜¯åˆ›å»ºæ–°è®¢å•æˆ–æ›¿æ¢æ•´ä¸ªåœ°å€

æ— ç‹¬ç«‹æŸ¥è¯¢ï¼šå¾ˆå°‘ä¼šå•ç‹¬æŸ¥è¯¢"æ‰€æœ‰åŒ—äº¬å¸‚çš„é…é€åœ°å€"

## æŠ€æœ¯è§’åº¦ï¼š

æ€§èƒ½ï¼šé¿å… JOIN æ“ä½œ

ä¸€è‡´æ€§ï¼šä¿è¯æ•°æ®åœ¨åŒä¸€äº‹åŠ¡ä¸­

ç®€å•æ€§ï¼šå‡å°‘è¡¨æ•°é‡å’Œç»´æŠ¤æˆæœ¬

# å¥½ï¼Œé‚£å¦‚æœæœ‰å¤šä¸ªåœ°å€å‘¢ shippingAddress

private Address shippingAddress; æ¯”æ–¹è¯´éœ€è¦å®šä¹‰æˆ private List<Address> shippingAddress; äº†

åœ°å€åˆ—è¡¨ï¼ˆåŠ¨æ€å¤šä¸ªåœ°å€ï¼‰
ä¸šåŠ¡åœºæ™¯ï¼š
ä¸€ä¸ªè®¢å•éœ€è¦é…é€åˆ°å¤šä¸ªåœ°ç‚¹

åˆ†æ‰¹å‘è´§

ä¸åŒå•†å“å‘å¾€ä¸åŒåœ°å€

æ•°æ®åº“è®¾è®¡ï¼šJSON å­˜å‚¨

```
CREATE TABLE orders (
    id BIGINT PRIMARY KEY,
    customer_id BIGINT,
    status VARCHAR(20),
    total_amount DECIMAL(10,2),

    -- å¤šä¸ªåœ°å€ä½œä¸ºJSONå­˜å‚¨
    shipping_addresses JSON,

    created_at TIMESTAMP
);

-- JSONç»“æ„ç¤ºä¾‹ï¼š
-- [
--   {
--     "type": "MAIN",
--     "province": "åŒ—äº¬å¸‚",
--     "city": "åŒ—äº¬å¸‚",
--     "street": "æµ·æ·€åŒºä¸­å…³æ‘å¤§è¡—1å·",
--     "zipCode": "100080",
--     "recipient": "å¼ ä¸‰",
--     "phone": "13800138000"
--   },
--   {
--     "type": "GIFT",
--     "province": "ä¸Šæµ·å¸‚",
--     "city": "ä¸Šæµ·å¸‚",
--     "street": "æµ¦ä¸œæ–°åŒºé™†å®¶å˜´ç¯è·¯1000å·",
--     "zipCode": "200120",
--     "recipient": "æå››",
--     "phone": "13900139000"
--   }
-- ]
```

## é¢†åŸŸæ¨¡å‹ï¼š

1. é¢†åŸŸæ¨¡å‹è®¾è®¡

```
public class Order {
    private OrderId id;
    private CustomerId customerId;
    private OrderStatus status;
    private List<ShippingAddress> shippingAddresses;  // åœ°å€åˆ—è¡¨
    private List<OrderItem> orderItems;

    // å€¼å¯¹è±¡ - å¸¦å…ƒæ•°æ®çš„é…é€åœ°å€
    public static class ShippingAddress {
        private final AddressType type;        // åœ°å€ç±»å‹
        private final Address address;         // åœ°å€è¯¦æƒ…
        private final String recipient;        // æ”¶ä»¶äºº
        private final String phone;            // è”ç³»ç”µè¯
        private final boolean isDefault;       // æ˜¯å¦é»˜è®¤åœ°å€

        public ShippingAddress(AddressType type, Address address,
                             String recipient, String phone, boolean isDefault) {
            this.type = type;
            this.address = address;
            this.recipient = recipient;
            this.phone = phone;
            this.isDefault = isDefault;
        }

        // getters...
    }

    public enum AddressType {
        MAIN,           // ä¸»é…é€åœ°å€
        GIFT,           // ç¤¼å“åœ°å€
        OFFICE,         // åŠå…¬å®¤åœ°å€
        WAREHOUSE,      // ä»“åº“åœ°å€
        PICKUP_POINT    // è‡ªæç‚¹
    }

    // ä¸šåŠ¡æ–¹æ³•
    public void addShippingAddress(AddressType type, Address address,
                                 String recipient, String phone, boolean isDefault) {
        // å¦‚æœè®¾ç½®ä¸ºé»˜è®¤åœ°å€ï¼Œå…ˆå–æ¶ˆå…¶ä»–é»˜è®¤åœ°å€
        if (isDefault) {
            shippingAddresses.forEach(addr -> addr.isDefault = false);
        }

        ShippingAddress newAddress = new ShippingAddress(type, address, recipient, phone, isDefault);
        this.shippingAddresses.add(newAddress);
    }

    public void removeShippingAddress(AddressType type) {
        shippingAddresses.removeIf(addr -> addr.getType() == type);
    }

    public Optional<ShippingAddress> getDefaultShippingAddress() {
        return shippingAddresses.stream()
            .filter(ShippingAddress::isDefault)
            .findFirst();
    }

    public List<ShippingAddress> getShippingAddressesByType(AddressType type) {
        return shippingAddresses.stream()
            .filter(addr -> addr.getType() == type)
            .collect(Collectors.toList());
    }
}
```

2. æ•°æ®åº“è®¾è®¡ - JSON å­˜å‚¨

```
CREATE TABLE orders (
    id BIGINT PRIMARY KEY,
    customer_id BIGINT,
    status VARCHAR(20),
    total_amount DECIMAL(10,2),

    -- å¤šä¸ªåœ°å€ä½œä¸ºJSONå­˜å‚¨
    shipping_addresses JSON,

    created_at TIMESTAMP,
    updated_at TIMESTAMP
);

-- JSONç»“æ„ç¤ºä¾‹ï¼š
/*
[
  {
    "type": "MAIN",
    "isDefault": true,
    "recipient": "å¼ ä¸‰",
    "phone": "13800138000",
    "address": {
      "province": "åŒ—äº¬å¸‚",
      "city": "åŒ—äº¬å¸‚",
      "district": "æµ·æ·€åŒº",
      "street": "ä¸­å…³æ‘å¤§è¡—1å·",
      "zipCode": "100080"
    }
  },
  {
    "type": "GIFT",
    "isDefault": false,
    "recipient": "æå››",
    "phone": "13900139000",
    "address": {
      "province": "ä¸Šæµ·å¸‚",
      "city": "ä¸Šæµ·å¸‚",
      "district": "æµ¦ä¸œæ–°åŒº",
      "street": "é™†å®¶å˜´ç¯è·¯1000å·",
      "zipCode": "200120"
    }
  }
]
*/
```

3. Repository å®ç°

```
@Repository
public class OrderRepositoryImpl implements OrderRepository {

    private final JdbcTemplate jdbcTemplate;
    private final ObjectMapper objectMapper;

    public Order findById(OrderId id) {
        String sql = "SELECT id, customer_id, status, shipping_addresses, created_at " +
                    "FROM orders WHERE id = ?";

        return jdbcTemplate.queryForObject(sql, (rs, rowNum) -> {
            Order order = new Order(
                new OrderId(rs.getLong("id")),
                new CustomerId(rs.getLong("customer_id")),
                OrderStatus.valueOf(rs.getString("status"))
            );

            // è§£æJSONåœ°å€åˆ—è¡¨
            String addressesJson = rs.getString("shipping_addresses");
            if (addressesJson != null) {
                List<Order.ShippingAddress> addresses = parseAddresses(addressesJson);
                order.setShippingAddresses(addresses);
            }

            return order;
        }, id.getValue());
    }

    public void save(Order order) {
        String sql = "INSERT INTO orders (id, customer_id, status, shipping_addresses, created_at) " +
                    "VALUES (?, ?, ?, ?, ?) " +
                    "ON DUPLICATE KEY UPDATE status = ?, shipping_addresses = ?, updated_at = ?";

        String addressesJson = serializeAddresses(order.getShippingAddresses());

        jdbcTemplate.update(sql,
            order.getId().getValue(),
            order.getCustomerId().getValue(),
            order.getStatus().name(),
            addressesJson,
            order.getCreatedAt(),
            order.getStatus().name(),
            addressesJson,
            LocalDateTime.now()
        );
    }

    private List<Order.ShippingAddress> parseAddresses(String json) {
        try {
            // ä½¿ç”¨Jacksonæˆ–å…¶ä»–JSONåº“è§£æ
            return objectMapper.readValue(json,
                objectMapper.getTypeFactory().constructCollectionType(
                    List.class, Order.ShippingAddress.class));
        } catch (Exception e) {
            throw new RuntimeException("Failed to parse addresses JSON", e);
        }
    }

    private String serializeAddresses(List<Order.ShippingAddress> addresses) {
        try {
            return objectMapper.writeValueAsString(addresses);
        } catch (Exception e) {
            throw new RuntimeException("Failed to serialize addresses", e);
        }
    }
}
```

4. ä½¿ç”¨ç¤ºä¾‹

```
// åˆ›å»ºè®¢å•å¹¶æ·»åŠ å¤šä¸ªåœ°å€
Order order = Order.create(customerId);

// æ·»åŠ ä¸»é…é€åœ°å€
order.addShippingAddress(
    AddressType.MAIN,
    new Address("åŒ—äº¬å¸‚", "åŒ—äº¬å¸‚", "æµ·æ·€åŒº", "ä¸­å…³æ‘å¤§è¡—1å·", "100080"),
    "å¼ ä¸‰",
    "13800138000",
    true
);

// æ·»åŠ ç¤¼å“åœ°å€
order.addShippingAddress(
    AddressType.GIFT,
    new Address("ä¸Šæµ·å¸‚", "ä¸Šæµ·å¸‚", "æµ¦ä¸œæ–°åŒº", "é™†å®¶å˜´ç¯è·¯1000å·", "200120"),
    "æå››",
    "13900139000",
    false
);

// ä¸šåŠ¡æ“ä½œï¼šè·å–é»˜è®¤é…é€åœ°å€
Order.ShippingAddress defaultAddress = order.getDefaultShippingAddress()
    .orElseThrow(() -> new NoShippingAddressException());

// ä¸šåŠ¡æ“ä½œï¼šæŒ‰ç±»å‹æŸ¥è¯¢åœ°å€
List<Order.ShippingAddress> giftAddresses = order.getShippingAddressesByType(AddressType.GIFT);
```

5. é€‚ç”¨ä¸šåŠ¡åœºæ™¯

è¿™ç§è®¾è®¡é€‚åˆï¼š

- ç¤¼å“è®¢å•ï¼šå•†å“é…é€åˆ°ä¸åŒæ”¶ä»¶äºº

- ä¼ä¸šé‡‡è´­ï¼šé…é€åˆ°ä¸åŒéƒ¨é—¨æˆ–åˆ†å…¬å¸

- åˆ†æ‰¹å‘è´§ï¼šå•†å“ä»ä¸åŒä»“åº“å‘è´§åˆ°ä¸åŒåœ°å€

- æ··åˆè®¢å•ï¼šéƒ¨åˆ†å•†å“é…é€åˆ°åŠå…¬å®¤ï¼Œéƒ¨åˆ†é…é€åˆ°å®¶é‡Œ
